if($user){
            try{
                $sheetEmpty = 0;
                $excelRecordId = 0;
                ini_set('memory_limit','-1');
                ini_set('max_execution_time',0);
                set_time_limit(0);

                DB::transaction(function() use($request, &$sheetEmpty, &$excelRecordId, $user){
                    $employerId = $request->employer_id;
                    $defaultPasswordFormatId = $request->default_password_format_id;
                    $diskSave = env('MEDIA_DISK', 'public');
                    $file = $request->file('default_password_sheet');
                    $fileName = time().$file->getClientOriginalName();
                    $fileUrl = $file->storeAs('User/DefaultPassword/Upload', $fileName, $diskSave);
                    try{
                        $errorReport = new ExcelErrorReports();
                        $errorReport->employer_id = $employerId;
                        $errorReport->document_type_id = ExcelErrorReports::USER_DEFAULT_PASSWORD;
                        $errorReport->original_document_url = Storage::disk($diskSave)->url($fileUrl) ? Storage::disk($diskSave)->url($fileUrl) : NULL;
                        $errorReport->status = ExcelErrorReports::PROCESSING;
                        $errorReport->created_by = $user->id;
                        $errorReport->save();
                        $errorReportId = $errorReport->id;
                        try{
                            $excelData = Excel::toArray(new DefaultPasswordImport($user, $employerId, $defaultPasswordFormatId, $errorReportId), $fileUrl, $diskSave);
                            // return $excelData;
                        } catch (Exception $e){
                            Log::error($e);
                        }
                        
                        try{
                            if(!isset($excelData[0][0])){
                                $sheetEmpty = 1;
                                $deleteExcel = ExcelErrorReports::find($errorReportId);
                                if(!empty($deleteExcel)){
                                    $deleteExcel->delete();
                                }
                            } else {
                                foreach($excelData[0]  as $key => $val){
                                    if(!empty($val['employee_code']) && !empty($defaultPasswordFormatId)){
                                        $dumpPasswordSave = new DumpDefaultPassword();
                                        $dumpPasswordSave->default_password_format_id = $defaultPasswordFormatId;
                                        $dumpPasswordSave->employer_id = $employerId;
                                        $dumpPasswordSave->excel_report_id = $errorReportId;
                                        $dumpPasswordSave->employee_code = $val['employee_code'];
                                        // $dumpPasswordSave->save();
                                    }
                                }
                                // dd("else conditional if loop", $dumpPasswordSave);  
                            }
                        }catch(Exception $e){
                            Log::error($e);
                        }
                        
                        $data = DumpDefaultPassword::with('employeeTable.user','employerDefaultPasswordConfigurator','masterDefaultPassword')->get();
                        $defaultPassword = NULL;
                        foreach ($data as $key=>$item) {
                            if($item->default_password_format_id == 4){
                                // return "EmployeeName@EmployeeCode";
                                $name = secure($item->employeeTable->user->name, 'D');
                                $defaultPassword = str_replace(' ','',$name.'@'.$item->employee_code);
                                
                            } elseif($item->default_password_format_id == 2) {
                                // return "EmployeeCode@DOJ";
                                $defaultPassword = str_replace(' ','', $item->employee_code.'@'.$item->employeeTable->doj);
                                
                            } elseif($item->default_password_format_id == 3) {
                                // return "EmployeeCode@DOB";
                                $defaultPassword = str_replace(' ','',$item->employee_code.'@'.$item->employeeTable->dob);

                            } elseif($item->default_password_format_id == 8){
                                // return "DOJ@EmployeeCode";
                                $name = secure($item->employeeTable->user->name, 'D');
                                $defaultPassword = str_replace(' ','',$item->employeeTable->doj.'@'.$item->employee_code);

                            } elseif($item->default_password_format_id == 5){
                                // return "EmployeeCode@EmployeeName";
                                $name = secure($item->employeeTable->user->name, 'D');
                                $defaultPassword = str_replace(' ','',$item->employee_code.'@'.$name);

                            } elseif($item->default_password_format_id == 6){
                                // return "EmployeeName@DOB";
                                $name = secure($item->employeeTable->user->name, 'D');
                                $defaultPassword = str_replace(' ','',$name . '@'. $item->employeeTable->dob);

                            } elseif($item->default_password_format_id == 7){
                                // return "EmployeeName@DOJ";
                                $name = secure($item->employeeTable->user->name, 'D');
                                $defaultPassword = str_replace(' ','',$name . '@'.$item->employeeTable->doj);

                            } elseif($item->default_password_format_id == 9){
                                // return "EmployeeCode@DomainName";
                                $val = explode("@",$item->employeeTable->user->email);
                                $defaultPassword = str_replace(' ','',$item->employee_code.'@'.$val[1]);
                            }
                            if($defaultPassword){
                                $user = User::where('id',$item->employeeTable->user_id)->first();
                                $user->default_password = $defaultPassword;
                                $user->password = Hash::make($defaultPassword);
                                $user->update();
                            }
                        }
                    }catch(Throwable $e){
                        Log::error($e);
                    }
                });

                if($sheetEmpty == 1){
                    return response()->json([
                        'status' =>false,
                        'message'=>'Sheet may be empty so please fill the all fields and upload again !!',
                    ]);
                }else{
                    $passwordJob = DefaultPasswordJob::dispatch($request->employer_id, $excelRecordId);
                    dd($passwordJob);
                    return response()->json([
                        'status'=> true,
                        'message'=> 'File uploaded successfully'
                    ]);
                }
            }catch(Throwable $e){
                Log::error($e);
            }
        }else{
            return response()->json([
                'status'=> false,
                'message'=> "User Not Found !!"
            ]);
        }
		
		
		

